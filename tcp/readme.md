### Документация к TCP-серверу

#### Общее описание
Этот TCP-сервер разработан для управления подключениями к различным устройствам (в данном случае, солнечным панелям). Он позволяет принимать, обрабатывать и отправлять данные от устройств, а также выполнять различные операции с базой данных.

#### Основные компоненты

- **TCPServer**: Главный класс сервера, управляющий подключениями и обеспечивающий связь между клиентами и сервером.
- **TCPConnection**: Класс, представляющий отдельное подключение к клиенту. Отвечает за обработку сообщений и взаимодействие с базой данных.

#### Основные функции

1. **Запуск сервера**: Инициализация и запуск TCP-сервера для прослушивания входящих подключений.
2. **Обработка подключений**: При подключении нового клиента создается временный уникальный ID, и подключение добавляется в словарь активных подключений.
3. **Чтение и отправка сообщений**: Сервер может читать сообщения от клиентов, обрабатывать их и отправлять обратные ответы.
4. **Работа с базой данных**: Отправка данных в базу данных и их обновление на основе полученной информации от клиентов.
5. **Управление активными подключениями**: Возможность выбора активного подключения для отправки сообщений и управления этим подключением.

#### Инструкция по использованию

1. **Запуск сервера**: Сервер запускается с заданными параметрами хоста, порта и конфигурации базы данных.
2. **Прослушивание подключений**: Сервер ожидает входящие подключения и обрабатывает их в асинхронном режиме.
3. **Обработка сообщений**: При получении сообщения от клиента сервер обрабатывает его и, при необходимости, обновляет данные в базе данных.
4. **Отправка сообщений**: Сервер может отправлять сообщения активному подключению, используя специальные команды.
5. **Остановка сервера**: Сервер можно остановить, что приведет к закрытию всех активных подключений и остановке прослушивания порта.

#### Требования к окружению

- Python 3.11+
- Библиотеки asyncio, asyncpg, json
- Настроенная база данных PostgreSQL.

#### Заметки по использованию

- Перед началом работы убедитесь, что база данных настроена и доступна.
- Внимательно следите за логами сервера для отслеживания состояния подключений и обработки данных.
- При необходимости настройте параметры логирования для получения более детальной информации о работе сервера.

#### Пример использования
# Создание и запуск сервера
database_config = {
    "user": "postgres", # имя пользователя БД postgreSQL
    "password": "password", # пароль
    "database": "dbname", # название БД
    "host": "localhost" # адрес БД
}
server = TCPServer('127.0.0.1', 1024, database_config)
asyncio.run(server.start_server())
